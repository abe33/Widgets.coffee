<!DOCTYPE html>  <html> <head>   <title>std.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="Cakefile.html">                 Cakefile.coffee               </a>                                           <a class="source" href="Nemfile.html">                 Nemfile.coffee               </a>                                           <a class="source" href="builder.html">                 builder.coffee               </a>                                           <a class="source" href="button.html">                 button.coffee               </a>                                           <a class="source" href="calendar.html">                 calendar.coffee               </a>                                           <a class="source" href="checkbox.html">                 checkbox.coffee               </a>                                           <a class="source" href="colorpicker.html">                 colorpicker.coffee               </a>                                           <a class="source" href="container.html">                 container.coffee               </a>                                           <a class="source" href="dates.html">                 dates.coffee               </a>                                           <a class="source" href="filepicker.html">                 filepicker.coffee               </a>                                           <a class="source" href="jquery.html">                 jquery.coffee               </a>                                           <a class="source" href="keys.html">                 keys.coffee               </a>                                           <a class="source" href="menus.html">                 menus.coffee               </a>                                           <a class="source" href="mixins.html">                 mixins.coffee               </a>                                           <a class="source" href="module.html">                 module.coffee               </a>                                           <a class="source" href="nem.html">                 nem.coffee               </a>                                           <a class="source" href="numeric-widget.html">                 numeric-widget.coffee               </a>                                           <a class="source" href="radio.html">                 radio.coffee               </a>                                           <a class="source" href="radiogroup.html">                 radiogroup.coffee               </a>                                           <a class="source" href="selects.html">                 selects.coffee               </a>                                           <a class="source" href="signals.html">                 signals.coffee               </a>                                           <a class="source" href="slider.html">                 slider.coffee               </a>                                           <a class="source" href="std.html">                 std.coffee               </a>                                           <a class="source" href="stepper.html">                 stepper.coffee               </a>                                           <a class="source" href="textarea.html">                 textarea.coffee               </a>                                           <a class="source" href="textinput.html">                 textinput.coffee               </a>                                           <a class="source" href="widgets.html">                 widgets.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               std.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p><link rel='stylesheet' href='../css/styles.css' media='screen'>
<link rel='stylesheet' href='../css/widgets.css' media='screen'></p>

<script type='text/javascript' src='../depends/jquery-1.6.1.min.js'></script>

<script type='text/javascript' src='../depends/jquery.mousewheel.js'></script>

<script type='text/javascript' src='../lib/widgets.js'></script>

<script type='text/javascript' src='../lib/builder.js'></script>

<p>This file contains all the additions to the Javascript standard classes
and utilities used accross the widgets files.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h1>Date</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>A group of constants for basic time and dates computations.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_SECOND</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_MINUTE</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_SECOND</span> <span class="o">*</span> <span class="mi">60</span>
<span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_HOUR</span>   <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_MINUTE</span> <span class="o">*</span> <span class="mi">60</span>
<span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_DAY</span>    <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_HOUR</span> <span class="o">*</span> <span class="mi">24</span>
<span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_WEEK</span>   <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_DAY</span> <span class="o">*</span> <span class="mi">7</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Returns a new <code>Date</code> object that is a copy of the current object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">clone </span><span class="o">=-&gt;</span> <span class="k">new</span> <span class="nb">Date</span> <span class="py">@valueOf</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h3>Fluent Accessors</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Either returns the full year of the date if called without argument
or set the full year of the current date and return the date object
if called with an argument.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">year </span><span class="o">=</span> <span class="p">(</span><span class="nx">year</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">year</span><span class="o">?</span> <span class="k">then</span> <span class="py">@setFullYear</span> <span class="nx">year</span><span class="p">;</span> <span class="py">this</span> <span class="k">else</span> <span class="py">@getFullYear</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Either returns the month of the date if called without argument
or set the month of the current date and return the date object
if called with an argument.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">month </span><span class="o">=</span> <span class="p">(</span><span class="nx">month</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">month</span><span class="o">?</span> <span class="k">then</span> <span class="py">@setMonth</span> <span class="nx">month</span><span class="p">;</span> <span class="py">this</span> <span class="k">else</span> <span class="py">@getMonth</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Either returns the date of the date if called without argument
or set the date of the current date and return the date object
if called with an argument.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">date </span><span class="o">=</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">date</span><span class="o">?</span> <span class="k">then</span> <span class="py">@setDate</span> <span class="nx">date</span><span class="p">;</span> <span class="py">this</span> <span class="k">else</span> <span class="py">@getDate</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Either returns the hours of the date if called without argument
or set the hours of the current date and return the date object
if called with an argument.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">hours </span><span class="o">=</span> <span class="p">(</span><span class="nx">hours</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">hours</span><span class="o">?</span> <span class="k">then</span> <span class="py">@setHours</span> <span class="nx">hours</span><span class="p">;</span> <span class="py">this</span> <span class="k">else</span> <span class="py">@getHours</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Either returns the minutes of the date if called without argument
or set the minutes of the current date and return the date object
if called with an argument.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">minutes </span><span class="o">=</span> <span class="p">(</span><span class="nx">minutes</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">minutes</span><span class="o">?</span> <span class="k">then</span> <span class="py">@setMinutes</span> <span class="nx">minutes</span><span class="p">;</span> <span class="py">this</span> <span class="k">else</span> <span class="py">@getMinutes</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Either returns the seconds of the date if called without argument
or set the seconds of the current date and return the date object
if called with an argument.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">seconds </span><span class="o">=</span> <span class="p">(</span><span class="nx">seconds</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">seconds</span><span class="o">?</span> <span class="k">then</span> <span class="py">@setSeconds</span> <span class="nx">seconds</span><span class="p">;</span> <span class="py">this</span> <span class="k">else</span> <span class="py">@getSeconds</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Either returns the milliseconds of the date if called without argument
or set the milliseconds of the current date and return the date object
if called with an argument.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">milliseconds </span><span class="o">=</span> <span class="p">(</span><span class="nx">milliseconds</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">milliseconds</span><span class="o">?</span> <span class="k">then</span> <span class="py">@setMilliseconds</span> <span class="nx">milliseconds</span><span class="p">;</span> <span class="py">this</span>
  <span class="k">else</span> <span class="py">@getMilliseconds</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <h3>Date Extra Informations</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Returns the week in which is the current date object. The <code>dowOffset</code>
arguments allow to change the day starting the weeks. For instance,
passing <code>-1</code> as offset will returns weeks that starts a sunday (monday is 1
and sunday is 0).</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">week </span><span class="o">=</span> <span class="p">(</span><span class="nv">dowOffset </span><span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">start </span><span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">findFirstWeekFirstDay</span> <span class="py">@getFullYear</span><span class="p">(),</span> <span class="nx">dowOffset</span>
  <span class="nv">timeOffset </span><span class="o">=</span> <span class="p">(</span><span class="py">@getTimezoneOffset</span><span class="p">()</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_MINUTE</span>
  <span class="nv">dif   </span><span class="o">=</span> <span class="py">this</span> <span class="o">-</span> <span class="nx">start</span> <span class="o">-</span> <span class="nx">timeOffset</span>
  <span class="nv">week  </span><span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span> <span class="p">(</span><span class="nx">dif</span> <span class="o">/</span> <span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_WEEK</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="nx">week</span> <span class="o">or</span> <span class="py">@firstDateOfMonth</span><span class="p">().</span><span class="nx">incrementDate</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">week</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Returns a <code>Date</code> object that represent the first day in the current month.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">firstDateOfMonth </span><span class="o">=-&gt;</span> <span class="py">@clone</span><span class="p">().</span><span class="nx">date</span> <span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Returns a <code>Date</code> object that represent the last day in the current month.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">lastDateOfMonth </span><span class="o">=-&gt;</span> <span class="py">@clone</span><span class="p">().</span><span class="nx">date</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">incrementMonth</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">incrementDate</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Returns the number of days in the current month.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">monthLength </span><span class="o">=-&gt;</span> <span class="py">@lastDateOfMonth</span><span class="p">().</span><span class="nx">date</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Returns the first day in the first week of the passed-in <code>year</code>.
The day starting the weeks can be adjusted with the <code>dowOffset</code>
argument. For instance, passing <code>-1</code> as offset will returns a sunday
instead of a monday.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">findFirstWeekFirstDay </span><span class="o">=</span> <span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nv">dowOffset </span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">d </span><span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span> <span class="nx">year</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
  <span class="nv">day </span><span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">getDay</span><span class="p">()</span> <span class="o">+</span> <span class="nx">dowOffset</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>

  <span class="nv">day </span><span class="o">=</span> <span class="mi">7</span> <span class="k">if</span> <span class="nx">day</span> <span class="o">is</span> <span class="mi">0</span>

  <span class="k">if</span> <span class="nx">day</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="k">then</span> <span class="k">new</span> <span class="nb">Date</span> <span class="nx">year</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span> <span class="o">-</span> <span class="nx">day</span><span class="p">,</span> <span class="mi">0</span>
  <span class="k">else</span> <span class="k">new</span> <span class="nb">Date</span> <span class="nx">year</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">-</span> <span class="nx">day</span><span class="p">,</span> <span class="mi">0</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <h3>Date Manipulation</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Increments the current <code>date</code> property of the <code>Date</code> object by <code>amount</code>
and returns the current date object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">incrementDate </span><span class="o">=</span> <span class="p">(</span><span class="nx">amount</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="py">@date</span> <span class="py">@date</span><span class="p">()</span> <span class="o">+</span> <span class="nx">amount</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Increments the current <code>month</code> property of the <code>Date</code> object by <code>amount</code>
and returns the current date object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">incrementMonth </span><span class="o">=</span> <span class="p">(</span><span class="nx">amount</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="py">@month</span> <span class="py">@month</span><span class="p">()</span> <span class="o">+</span> <span class="nx">amount</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Increments the current <code>year</code> property of the <code>Date</code> object by <code>amount</code>
and returns the current date object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">incrementYear </span><span class="o">=</span> <span class="p">(</span><span class="nx">amount</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="py">@year</span> <span class="py">@year</span><span class="p">()</span> <span class="o">+</span> <span class="nx">amount</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <h3>Date Comparison</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Compares two <code>Date</code> objets. Both the date and the time ar compared.
If <code>milliseconds</code> is true the comparison is also performed on the
<code>milliseconds</code> property of the two dates.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">equals </span><span class="o">=</span> <span class="p">(</span><span class="nx">date</span><span class="p">,</span> <span class="nv">milliseconds </span><span class="o">=</span><span class="kc">false</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="py">@dateEquals</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">and</span> <span class="py">@timeEquals</span><span class="p">(</span><span class="nx">date</span><span class="p">,</span> <span class="nx">milliseconds</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Compare the date of two <code>Date</code> objects. That means that two dates
with different times will match if their year, month and date
are equals.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">dateEquals </span><span class="o">=</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="py">@year</span><span class="p">()</span>  <span class="o">is</span> <span class="nx">date</span><span class="p">.</span><span class="nx">year</span><span class="p">()</span>  <span class="o">and</span>
  <span class="py">@month</span><span class="p">()</span> <span class="o">is</span> <span class="nx">date</span><span class="p">.</span><span class="nx">month</span><span class="p">()</span> <span class="o">and</span>
  <span class="py">@date</span><span class="p">()</span>  <span class="o">is</span> <span class="nx">date</span><span class="p">.</span><span class="nx">date</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Compare the time of two <code>Date</code> object. That means that two dates
with different dates will match if their hours, minutes and seconds
are equals. The comparison can be extended to the milliseconds of
each date objects by passing true in the <code>milliseconds</code> argument.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">timeEquals </span><span class="o">=</span> <span class="p">(</span><span class="nx">date</span><span class="p">,</span> <span class="nv">milliseconds </span><span class="o">=</span><span class="kc">false</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="py">@hours</span><span class="p">()</span>   <span class="o">is</span> <span class="nx">date</span><span class="p">.</span><span class="nx">hours</span><span class="p">()</span>   <span class="o">and</span>
  <span class="py">@minutes</span><span class="p">()</span> <span class="o">is</span> <span class="nx">date</span><span class="p">.</span><span class="nx">minutes</span><span class="p">()</span> <span class="o">and</span>
  <span class="py">@seconds</span><span class="p">()</span> <span class="o">is</span> <span class="nx">date</span><span class="p">.</span><span class="nx">seconds</span><span class="p">()</span> <span class="o">and</span>
  <span class="k">if</span> <span class="nx">milliseconds</span> <span class="k">then</span> <span class="py">@milliseconds</span><span class="p">()</span> <span class="o">is</span> <span class="nx">date</span><span class="p">.</span><span class="nx">milliseconds</span><span class="p">()</span> <span class="k">else</span> <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Returns true if the current date is today.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="o">::</span><span class="nv">isToday </span><span class="o">=-&gt;</span> <span class="py">@dateEquals</span> <span class="k">new</span> <span class="nb">Date</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <h3>Time Conversion</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Match if the passed-in string is a valid time string.
The following strings are considered as valid :
<code>10</code>, <code>10:15</code>, <code>10:15:40</code> or <code>10:15:40.768</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">isValidTime </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">return</span> <span class="kc">false</span> <span class="k">unless</span> <span class="nx">string</span><span class="o">?</span>
  <span class="p">(</span><span class="sr">///</span> <span class="sro">^</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span>             <span class="c1"># Hours are required</span>
    <span class="sro">(</span><span class="sr">:</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span>           <span class="c1"># Minutes are optional</span>
      <span class="sro">(</span><span class="sr">:</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span>         <span class="c1"># Seconds as well</span>
        <span class="sro">(</span><span class="sr">\.</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">1,4</span><span class="sro">})?</span>  <span class="c1"># Milliseconds too</span>
      <span class="sro">)?</span>                <span class="c1"># End Seconds</span>
    <span class="sro">)?</span>                  <span class="c1"># End Minutes</span>
  <span class="sro">$</span> <span class="sr">///</span><span class="p">).</span><span class="nx">test</span> <span class="nx">string</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Converts a time string into a <code>Date</code> object where the time properties,
hours, minutes, seconds and milliseconds, are sets with the provided
datas or <code>0</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">timeFromString </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="p">[</span><span class="nx">hours</span><span class="p">,</span> <span class="nx">min</span><span class="p">,</span> <span class="nx">sec</span><span class="p">]</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">split</span> <span class="s">&quot;:&quot;</span>
  <span class="p">[</span><span class="nx">sec</span><span class="p">,</span> <span class="nx">ms</span> <span class="p">]</span> <span class="o">=</span> <span class="k">if</span> <span class="nx">sec</span><span class="o">?</span> <span class="k">then</span> <span class="nx">sec</span><span class="p">.</span><span class="nx">split</span> <span class="s">&quot;.&quot;</span> <span class="k">else</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>UTC dates start at 1: 00 AM so we have to remove one hour.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">time </span><span class="o">=</span> <span class="nx">safeInt</span><span class="p">(</span><span class="nx">hours</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_HOUR</span>   <span class="o">+</span>
         <span class="nx">safeInt</span><span class="p">(</span><span class="nx">min</span><span class="p">)</span>       <span class="o">*</span> <span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_MINUTE</span> <span class="o">+</span>
         <span class="nx">safeInt</span><span class="p">(</span><span class="nx">sec</span><span class="p">)</span>       <span class="o">*</span> <span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_SECOND</span> <span class="o">+</span>
         <span class="nx">safeInt</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span>

  <span class="nv">d </span><span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span> <span class="nx">time</span>
  <span class="nx">d</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Converts a <code>Date</code> object in a string such as <code>10:15:40</code>.
If the milliseconds count is different than <code>0</code> then the
output will look like <code>10:15:40.768</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">timeToString </span><span class="o">=</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">h  </span><span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">hours</span><span class="p">()</span>
  <span class="nv">m  </span><span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">minutes</span><span class="p">()</span>
  <span class="nv">s  </span><span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">seconds</span><span class="p">()</span>
  <span class="nv">ms </span><span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">milliseconds</span><span class="p">()</span>

  <span class="nv">time </span><span class="o">=</span><span class="s">&quot;</span><span class="si">#{</span> <span class="nx">fill</span> <span class="nx">h</span> <span class="si">}</span><span class="s">:</span><span class="si">#{</span> <span class="nx">fill</span> <span class="nx">m</span> <span class="si">}</span><span class="s">:</span><span class="si">#{</span> <span class="nx">fill</span> <span class="nx">s</span> <span class="si">}</span><span class="s">&quot;</span>
  <span class="nx">time</span> <span class="o">+=</span> <span class="s">&quot;.</span><span class="si">#{</span> <span class="nx">ms</span> <span class="si">}</span><span class="s">&quot;</span> <span class="k">if</span> <span class="nx">ms</span> <span class="o">isnt</span> <span class="mi">0</span>
  <span class="nx">time</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <h3>Date Conversion</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>A valid date is a string such as <code>2012-12-29</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">isValidDate </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">unless</span> <span class="nx">string</span><span class="o">?</span> <span class="k">then</span> <span class="k">return</span> <span class="kc">false</span>
  <span class="p">(</span><span class="sr">///</span> <span class="sro">^</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">4</span><span class="sro">}</span><span class="sr">-   </span><span class="c1"># Year</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span><span class="sr">-   </span><span class="c1"># Month</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span>    <span class="c1"># Day of the month</span>
  <span class="sro">$</span> <span class="sr">///</span><span class="p">).</span><span class="nx">test</span> <span class="nx">string</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>A valid date string can be passed directly to the <code>Date</code> constructor.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">dateFromString </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">d </span><span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span> <span class="nx">string</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Hours may vary when constructing a <code>Date</code> from a date string.
The returned date's hours are then reset to <code>0</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">d</span><span class="p">.</span><span class="nx">setHours</span> <span class="mi">0</span>
  <span class="nx">d</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Converts a <code>Date</code> object in a string such as <code>2007-05-22</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">dateToString </span><span class="o">=</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="s">&quot;</span><span class="si">#{</span> <span class="nx">fill</span> <span class="nx">date</span><span class="p">.</span><span class="nx">year</span><span class="p">(),</span> <span class="mi">4</span> <span class="si">}</span><span class="s">-</span><span class="si">#{</span> <span class="nx">fill</span> <span class="nx">date</span><span class="p">.</span><span class="nx">month</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="si">}</span><span class="s">-</span><span class="si">#{</span> <span class="nx">fill</span> <span class="nx">date</span><span class="p">.</span><span class="nx">date</span><span class="p">()</span> <span class="si">}</span><span class="s">&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <h3>Month Conversion</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>A valid month is a string such as <code>2011-02</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">isValidMonth </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">return</span> <span class="kc">false</span> <span class="k">unless</span> <span class="nx">string</span><span class="o">?</span>
  <span class="p">(</span><span class="sr">///</span> <span class="sro">^</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">4</span><span class="sro">}</span><span class="sr">-   </span><span class="c1"># Year</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span>    <span class="c1"># Month</span>
  <span class="sro">$</span> <span class="sr">///</span><span class="p">).</span><span class="nx">test</span> <span class="nx">string</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Creates a new <code>Date</code> that correspond to the first day
of the passed-in string.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">monthFromString </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">d </span><span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span> <span class="nx">string</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Hours may vary when constructing a <code>Date</code>.
The returned date's hours are then reset to <code>0</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">d</span><span class="p">.</span><span class="nx">setHours</span> <span class="mi">0</span>
  <span class="nx">d</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>Converts a <code>Date</code> object in a string such as <code>2007-05</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">monthToString </span><span class="o">=</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="s">&quot;</span><span class="si">#{</span> <span class="nx">fill</span> <span class="nx">date</span><span class="p">.</span><span class="nx">year</span><span class="p">(),</span> <span class="mi">4</span> <span class="si">}</span><span class="s">-</span><span class="si">#{</span> <span class="nx">fill</span> <span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">month</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="si">}</span><span class="s">&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <h3>Week Conversion</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>A valid week is a string such as <code>2012-W16</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">isValidWeek </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">return</span> <span class="kc">false</span> <span class="k">unless</span> <span class="nx">string</span><span class="o">?</span>
  <span class="p">(</span><span class="sr">///</span> <span class="sro">^</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">4</span><span class="sro">}</span>    <span class="c1"># Year</span>
    <span class="sr">-W         </span><span class="c1"># Week separator</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span>    <span class="c1"># Week number prefixed with W</span>
  <span class="sro">$</span> <span class="sr">///</span><span class="p">).</span><span class="nx">test</span> <span class="nx">string</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>Converts a string such as <code>2011-W09</code> into a <code>Date</code> object
that represent the first day of the corresponding week, even
if it's not in the same year.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">weekFromString </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="p">[</span><span class="nx">year</span><span class="p">,</span> <span class="nx">week</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">parseInt</span> <span class="nx">s</span> <span class="k">for</span> <span class="nx">s</span> <span class="k">in</span> <span class="nx">string</span><span class="p">.</span><span class="nx">split</span> <span class="s">&quot;-W&quot;</span><span class="p">)</span>

  <span class="nb">Date</span><span class="p">.</span><span class="nx">getWeekDate</span> <span class="nx">year</span><span class="p">,</span> <span class="nx">week</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>Converts a <code>Date</code> object in a string such as <code>2011-W15</code>.
The week correspond to the week the passed-in date was in.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">weekToString </span><span class="o">=</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="s">&quot;</span><span class="si">#{</span> <span class="nx">fill</span> <span class="nx">date</span><span class="p">.</span><span class="nx">year</span><span class="p">(),</span> <span class="mi">4</span> <span class="si">}</span><span class="s">-W</span><span class="si">#{</span> <span class="nx">fill</span> <span class="nx">date</span><span class="p">.</span><span class="nx">week</span><span class="p">()</span> <span class="si">}</span><span class="s">&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>Returns the first day of the passed-in week of the specified year.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">getWeekDate </span><span class="o">=</span> <span class="p">(</span><span class="nx">year</span><span class="p">,</span> <span class="nx">week</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">start </span><span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">findFirstWeekFirstDay</span> <span class="nx">year</span>
  <span class="nv">date </span><span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span> <span class="nx">start</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">()</span> <span class="o">+</span> <span class="nb">Date</span><span class="p">.</span><span class="nb">MILLISECONDS_IN_WEEK</span> <span class="o">*</span> <span class="p">(</span><span class="nx">week</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
  <span class="nx">date</span><span class="p">.</span><span class="nx">hours</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">minutes</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">seconds</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">milliseconds</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <h3>DateTime Conversion</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>A valid datetime is a string such as <code>2016-05-12T18:55:34.765+02:00</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">isValidDateTime </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">return</span> <span class="kc">false</span> <span class="k">unless</span> <span class="nx">string</span><span class="o">?</span>
  <span class="p">(</span><span class="sr">///</span> <span class="sro">^</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">4</span><span class="sro">}</span><span class="sr">-       </span><span class="c1"># Year</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span><span class="sr">-       </span><span class="c1"># Month</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span>        <span class="c1"># Day of the Month</span>
    <span class="sr">T              </span><span class="c1"># Start time token</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span><span class="sr">:       </span><span class="c1"># Hours</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span><span class="sr">:       </span><span class="c1"># Minutes</span>
    <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span>        <span class="c1"># Seconds</span>
    <span class="sro">(</span><span class="sr">\.</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">1,4</span><span class="sro">})?</span> <span class="c1"># Optionnal milliseconds</span>
    <span class="sro">(</span>              <span class="c1"># Mandatory terminator</span>
      <span class="sr">Z|           </span><span class="c1"># Either Z or</span>
      <span class="sro">(</span><span class="sr">\</span><span class="sro">+|</span><span class="sr">\-</span><span class="sro">){</span><span class="sri">1</span><span class="sro">}</span>   <span class="c1"># +XX:XX or -XX: XX</span>
      <span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span><span class="sr">:</span>
<span class="sr">      </span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">}</span>
    <span class="sro">)</span>
  <span class="sro">$</span> <span class="sr">///</span><span class="p">).</span><span class="nx">test</span> <span class="nx">string</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>Converts a string such as <code>2016-05-12T18:55:34.765+02:00</code>
in the corresponding <code>Date</code> object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">datetimeFromString </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nb">Date</span> <span class="nx">string</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>Converts a <code>Date</code> object in a string such as <code>2016-05-12T18:55:34.765+02:00</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">datetimeToString </span><span class="o">=</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">-&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>Stores that function in shorter local variable
to inline the output string.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">dts </span><span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">dateToString</span>
  <span class="nv">tts </span><span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">timeToString</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>Here the <code>Date</code> object for you. The time zone offset is written
as <code>+02:00</code> and the <code>Date.getTimezoneOffset</code> function return <code>-120</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">offset </span><span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getTimezoneOffset</span><span class="p">()</span>
  <span class="nv">sign </span><span class="o">=</span> <span class="s">&quot;-&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>That mean that the plus sign appear when <code>offset &lt; 0</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="p">[</span><span class="nx">sign</span><span class="p">,</span> <span class="nx">offset</span> <span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="s">&quot;+&quot;</span><span class="p">,</span> <span class="nx">offset</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nx">offset</span> <span class="o">&lt;</span> <span class="mi">0</span>

  <span class="nv">minutes </span><span class="o">=</span> <span class="nx">offset</span> <span class="o">%</span> <span class="mi">60</span>
  <span class="nv">hours </span><span class="o">=</span> <span class="p">(</span><span class="nx">offset</span> <span class="o">-</span> <span class="nx">minutes</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span>
  <span class="s">&quot;</span><span class="si">#{</span> <span class="nx">dts</span> <span class="nx">date</span> <span class="si">}</span><span class="s">T</span><span class="si">#{</span> <span class="nx">tts</span> <span class="nx">date</span> <span class="si">}#{</span> <span class="nx">sign</span> <span class="si">}#{</span> <span class="nx">fill</span> <span class="nx">hours</span> <span class="si">}</span><span class="s">:</span><span class="si">#{</span> <span class="nx">fill</span> <span class="nx">minutes</span> <span class="si">}</span><span class="s">&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <h3>DateTimeLocal Conversion</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>The validation expression will also serve to parse each
components of a local datetime.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">dateTimeLocalRE </span><span class="o">=</span> <span class="o">-&gt;</span>
  <span class="sr">///</span> <span class="sro">^</span>
    <span class="sro">(</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">4</span><span class="sro">})</span><span class="sr">-     </span><span class="c1"># Year</span>
    <span class="sro">(</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">})</span><span class="sr">-     </span><span class="c1"># Month</span>
    <span class="sro">(</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">})</span>      <span class="c1"># Day of the Month</span>
    <span class="sr">T              </span><span class="c1"># Start time token</span>
    <span class="sro">(</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">})</span><span class="sr">:     </span><span class="c1"># Hours</span>
    <span class="sro">(</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">})</span><span class="sr">:     </span><span class="c1"># Minutes</span>
    <span class="sro">(</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">2</span><span class="sro">})</span>      <span class="c1"># Seconds</span>
    <span class="sro">(</span><span class="sr">\.</span><span class="src">[</span><span class="sre">\d</span><span class="src">]</span><span class="sro">{</span><span class="sri">1,3</span><span class="sro">})?</span> <span class="c1"># Optionnal milliseconds</span>
  <span class="sro">$</span> <span class="sr">///</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>A valid local datetime is a string such as <code>2016-05-12T18:55:34.765+02:00</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">isValidDateTimeLocal </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">return</span> <span class="kc">false</span> <span class="k">unless</span> <span class="nx">string</span><span class="o">?</span>
  <span class="nb">Date</span><span class="p">.</span><span class="nx">dateTimeLocalRE</span><span class="p">().</span><span class="nx">test</span> <span class="nx">string</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>Converts the passed-in string in a <code>Date</code> object.</p>

<p>Passing the date string directly in the constructor is valid,
however the behavior in chrome and firefox are quite different,
chrome consider that the passed-in date has an offset of <code>0</code>
and the convert it to the current local offset when firefox
consider the datestring as in the current local offset.
In consequences, The date will differ between the two browsers
of the amount of the current local offset.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Date</span><span class="p">.</span><span class="nv">datetimeLocalFromString </span><span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">-&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>The <code>Date</code> will be created by parsing the string with the validation
regex and pass each value as an argument in the <code>Date</code> constructor.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="p">[</span> <span class="nx">match</span><span class="p">,</span> <span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span>
    <span class="nx">day</span><span class="p">,</span> <span class="nx">hours</span><span class="p">,</span> <span class="nx">minutes</span><span class="p">,</span>
    <span class="nx">seconds</span><span class="p">,</span> <span class="nx">milliseconds</span> <span class="p">]</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">dateTimeLocalRE</span><span class="p">().</span><span class="nx">exec</span> <span class="nx">string</span>

  <span class="nv">pI </span><span class="o">=</span> <span class="nb">parseInt</span>
  <span class="k">new</span> <span class="nb">Date</span> <span class="nx">pI</span><span class="p">(</span><span class="nx">year</span>   <span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
           <span class="nx">pI</span><span class="p">(</span><span class="nx">month</span>  <span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
           <span class="nx">pI</span><span class="p">(</span><span class="nx">day</span>    <span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
           <span class="nx">pI</span><span class="p">(</span><span class="nx">hours</span>  <span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
           <span class="nx">pI</span><span class="p">(</span><span class="nx">minutes</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
           <span class="nx">pI</span><span class="p">(</span><span class="nx">seconds</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
           <span class="k">if</span> <span class="nx">milliseconds</span><span class="o">?</span> <span class="k">then</span> <span class="nx">pI</span><span class="p">(</span><span class="nx">milliseconds</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>

<span class="nb">Date</span><span class="p">.</span><span class="nv">datetimeLocalToString </span><span class="o">=</span> <span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="s">&quot;</span><span class="si">#{</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">dateToString</span> <span class="nx">date</span> <span class="si">}</span><span class="s">T</span><span class="si">#{</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">timeToString</span> <span class="nx">date</span> <span class="si">}</span><span class="s">&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <h1>Utilities</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>Cast the <code>value</code> into an integer.
In case the passed-in <code>value</code> cannot be casted in an
integer, the function return the value of <code>0</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">safeInt </span><span class="o">=</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">n </span><span class="o">=</span> <span class="nb">parseInt</span> <span class="nx">value</span>
  <span class="k">unless</span> <span class="nb">isNaN</span> <span class="nx">n</span> <span class="k">then</span> <span class="nx">n</span> <span class="k">else</span> <span class="mi">0</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>Fills the string <code>s</code> with <code>0</code> until its length is
equal to the length <code>l</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">fill </span><span class="o">=</span> <span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nv">l </span><span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">s </span><span class="o">=</span> <span class="nb">String</span> <span class="nx">s</span>
  <span class="nv">s </span><span class="o">=</span> <span class="s">&quot;0</span><span class="si">#{</span><span class="nx">s</span><span class="si">}</span><span class="s">&quot;</span> <span class="k">while</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">l</span>
  <span class="nx">s</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 