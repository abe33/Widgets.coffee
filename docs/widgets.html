<!DOCTYPE html>  <html> <head>   <title>widgets.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="Cakefile.html">                 Cakefile.coffee               </a>                                           <a class="source" href="builder.html">                 builder.coffee               </a>                                           <a class="source" href="button.html">                 button.coffee               </a>                                           <a class="source" href="calendar.html">                 calendar.coffee               </a>                                           <a class="source" href="checkbox.html">                 checkbox.coffee               </a>                                           <a class="source" href="colorpicker.html">                 colorpicker.coffee               </a>                                           <a class="source" href="container.html">                 container.coffee               </a>                                           <a class="source" href="dates.html">                 dates.coffee               </a>                                           <a class="source" href="filepicker.html">                 filepicker.coffee               </a>                                           <a class="source" href="jquery.html">                 jquery.coffee               </a>                                           <a class="source" href="keys.html">                 keys.coffee               </a>                                           <a class="source" href="menus.html">                 menus.coffee               </a>                                           <a class="source" href="mixins.html">                 mixins.coffee               </a>                                           <a class="source" href="module.html">                 module.coffee               </a>                                           <a class="source" href="numeric-widget.html">                 numeric-widget.coffee               </a>                                           <a class="source" href="radio.html">                 radio.coffee               </a>                                           <a class="source" href="radiogroup.html">                 radiogroup.coffee               </a>                                           <a class="source" href="selects.html">                 selects.coffee               </a>                                           <a class="source" href="signals.html">                 signals.coffee               </a>                                           <a class="source" href="slider.html">                 slider.coffee               </a>                                           <a class="source" href="std.html">                 std.coffee               </a>                                           <a class="source" href="stepper.html">                 stepper.coffee               </a>                                           <a class="source" href="textarea.html">                 textarea.coffee               </a>                                           <a class="source" href="textinput.html">                 textinput.coffee               </a>                                           <a class="source" href="widgets.html">                 widgets.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               widgets.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p><link rel="stylesheet" href="../css/styles.css" media="screen"></p>

<p>A Widget allow to work with or without a target <code>&lt;input&gt;</code> node, and provides
methods to reflect changes done on the widget onto its target.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nb">Widget</span> <span class="k">extends</span> <span class="nb">Module</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Pass a <code>&lt;input&gt;</code> node to the constructor to define the widget's target.
An error is raised if the passed-in node's name is not <code>input</code> or if
the arguments is not a node.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">constructor</span><span class="o">:</span><span class="p">(</span> <span class="nx">target</span> <span class="p">)</span><span class="o">-&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>If a target is provided to a widget, that target will
be verified in the <code>checkTarget</code> method.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="nx">target</span><span class="o">?</span> <span class="k">then</span> <span class="py">@checkTarget</span> <span class="nx">target</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <h3>Widget Signals</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>The <code>propertyChanged</code> signal is dispatched when a call
to the <code>set</code> method is performed.</p>

<p><em>Callback arguments</em></p>

<ul>
<li><code>widget</code>    : The widget that was modified.</li>
<li><code>property</code>  : The property that was modified.</li>
<li><code>value</code>     : The new value for this property.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@propertyChanged</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Signal</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>The <code>valueChanged</code> signal is dispatched when the <code>value</code>
property of the widget is modified.</p>

<p><em>Callback arguments</em></p>

<ul>
<li><code>widget</code>    : The widget that was modified.</li>
<li><code>value</code>     : The new value for this widget.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@valueChanged</span>    <span class="o">=</span> <span class="k">new</span> <span class="nb">Signal</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>The <code>stateChanged</code> signal is dispatched when the state
of the widget's dummy is modified.</p>

<p><em>Callback arguments</em></p>

<ul>
<li><code>widget</code>    : The widget that was modified.</li>
<li><code>state</code>     : The new state of the dummy.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@stateChanged</span>    <span class="o">=</span> <span class="k">new</span> <span class="nb">Signal</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>The <code>attached</code> signal is dispatched when the widget
is added to the DOM with the <code>attach</code> method.</p>

<p><em>Callback arguments</em></p>

<ul>
<li><code>widget</code>    : The widget that was modified.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@attached</span>        <span class="o">=</span> <span class="k">new</span> <span class="nb">Signal</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>The <code>detached</code> signal is dispatched when the widget
is removed from the DOM with the <code>detach</code> method.</p>

<p><em>Callback arguments</em></p>

<ul>
<li><code>widget</code>    : The widget that was modified.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@detached</span>        <span class="o">=</span> <span class="k">new</span> <span class="nb">Signal</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <h3>Widget Target Related Properties.</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>The <code>jTarget</code> property contains the <code>jQuery</code> object
for the target. However, if <code>target</code> is <code>null</code>,
the <code>jTarget</code> property will be <code>null</code> as well.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@target</span>    <span class="o">=</span> <span class="nx">target</span>
    <span class="py">@hasTarget</span> <span class="o">=</span> <span class="nx">target</span><span class="o">?</span>
    <span class="py">@jTarget</span>   <span class="o">=</span> <span class="k">if</span> <span class="py">@hasTarget</span> <span class="k">then</span> <span class="nx">$</span> <span class="nx">target</span> <span class="k">else</span> <span class="kc">null</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <h3>Shared Properties</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>The shared properties represent the properties of the input that
are available from and reflected on the widget. These properties
are accessible only through the <code>get</code> and <code>set</code> method.
For instance, to disable the widget use the following code:</p>

<pre><code>widget.set "disabled", true
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Default properties's values are retreived from the target or set to
<code>undefined</code> if there's no target specified.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@disabled</span> <span class="o">?=</span> <span class="py">@booleanFromAttribute</span> <span class="s">&quot;disabled&quot;</span>
    <span class="py">@readonly</span> <span class="o">?=</span> <span class="py">@booleanFromAttribute</span> <span class="s">&quot;readonly&quot;</span>
    <span class="py">@required</span> <span class="o">?=</span> <span class="py">@booleanFromAttribute</span> <span class="s">&quot;required&quot;</span>
    <span class="py">@value</span>    <span class="o">?=</span> <span class="py">@valueFromAttribute</span>   <span class="s">&quot;value&quot;</span>
    <span class="py">@name</span>     <span class="o">?=</span> <span class="py">@valueFromAttribute</span>   <span class="s">&quot;name&quot;</span>
    <span class="py">@id</span>       <span class="o">?=</span> <span class="kc">null</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Dummy creation is done in the <code>createDummy</code> method.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@dummy</span> <span class="o">=</span> <span class="py">@createDummy</span><span class="p">()</span>
    <span class="py">@hasDummy</span> <span class="o">=</span> <span class="py">@dummy</span><span class="o">?</span>
    <span class="py">@hasFocus</span> <span class="o">=</span> <span class="kc">false</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Since there's no way to know if an object is a descendant
of the Widget class, this property will act as a marker
for widget's instances.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@isWidget</span> <span class="o">=</span> <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>When added as child in a <code>Container</code> the <code>parent</code> property
store a reference to the parent.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@parent</span> <span class="o">=</span> <span class="kc">null</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>The commands for <code>keydown</code> and <code>keyup</code> events are stored
in two different objects.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@keyDownCommands</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="py">@keyUpCommands</span> <span class="o">=</span> <span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Additional setup if a target have been specified</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="py">@hasTarget</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Storing the initial value for reset.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="py">@targetInitialValue</span> <span class="o">=</span> <span class="py">@get</span> <span class="s">&quot;value&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Bind target's change event to handle it internally.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="py">@jTarget</span><span class="p">.</span><span class="nx">bind</span> <span class="s">&quot;change&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="o">=&gt;</span>
        <span class="py">@targetChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Flag the target to prevent the jquery plugins to iterate over
the input target of the widget.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="py">@jTarget</span><span class="p">.</span><span class="nx">addClass</span> <span class="s">&quot;widget-done&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Additional setup if a dummy have been created.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="py">@hasDummy</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>The <code>dummyStates</code> property stores the list of shared properties
that should be reflected as a class on the dummy. The order
of the states in the list are preserved in the dummy's class
attribute.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="py">@dummyStates</span> <span class="o">=</span> <span class="p">[</span> <span class="s">&quot;disabled&quot;</span><span class="p">,</span> <span class="s">&quot;readonly&quot;</span><span class="p">,</span> <span class="s">&quot;required&quot;</span> <span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Enforce the ability of the dummy to receive focus if enabled.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="py">@setFocusable</span> <span class="o">not</span> <span class="py">@get</span> <span class="s">&quot;disabled&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>The original class of the dummy is stored for later use.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="py">@dummyClass</span> <span class="o">=</span> <span class="py">@dummy</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&quot;class&quot;</span>

      <span class="k">if</span> <span class="py">@hasTarget</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>The style set on the target is copied on the dummy.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="py">@dummy</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&quot;style&quot;</span><span class="p">,</span> <span class="py">@jTarget</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&quot;style&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Same thing for the target classes.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">classes </span><span class="o">=</span> <span class="py">@jTarget</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&quot;class&quot;</span>
        <span class="py">@addClasses</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">classes</span><span class="p">.</span><span class="nx">split</span> <span class="sr">/\s+/g</span> <span class="p">)</span> <span class="k">if</span> <span class="nx">classes</span><span class="o">?</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>If the target had an <code>id</code> attribute, the widget's id
will be derived from it such as <code>#{ original id }-widget</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">id </span><span class="o">=</span> <span class="py">@jTarget</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&quot;id&quot;</span>
        <span class="k">if</span> <span class="nx">id</span><span class="o">?</span> <span class="o">and</span> <span class="nx">id</span> <span class="o">isnt</span> <span class="s">&quot;&quot;</span> <span class="k">then</span> <span class="py">@set</span> <span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">#{</span> <span class="nx">id</span> <span class="si">}</span><span class="s">-widget&quot;</span>

      <span class="py">@registerToDummyEvents</span><span class="p">()</span>
      <span class="py">@updateStates</span><span class="p">()</span>

    <span class="k">super</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <h3>Properties Accessors</h3>

<p>Properties of a widgets can be accessed either directly
or through the <code>get</code> and <code>set</code> methods of the widget.</p>

<p>Generally, its a bad idea to set a widget's properties
directly on the widget. Some properties implies changes
in other parts of the widgets and updates of its dummy,
so they should be accessed through the <code>set</code> method.
The same goes for retrieving the value of a property
since the value of some properties may be affected
by some other factors (see the <code>disabled</code> or <code>readonly</code>
properties for a concrete exemple).</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>When called, the <code>get</code> method will check for the existence
of a custom getter handler for the property, if one exist
the result of the call is returned, otherwise the value
stored in the property is returned.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">get</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="s">&quot;get_</span><span class="si">#{</span><span class="nx">property</span><span class="si">}</span><span class="s">&quot;</span> <span class="k">of</span> <span class="k">this</span>
      <span class="py">@</span><span class="p">[</span> <span class="s">&quot;get_</span><span class="si">#{</span><span class="nx">property</span><span class="si">}</span><span class="s">&quot;</span> <span class="p">].</span><span class="nx">call</span> <span class="k">this</span><span class="p">,</span> <span class="nx">property</span>
    <span class="k">else</span>
      <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>The <code>set</code> method allow two way of use, the first is
two pass the property's name as the first argument
and the value as the second argument, such as :</p>

<pre><code>widget.set "name", "someName"
</code></pre>

<p>The second way is by passing an object to the method
to modify several properties in one call, such as :</p>

<pre><code>widget.set
    name:"someName"
    value:"someValue"
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">set</span><span class="o">:</span><span class="p">(</span> <span class="nx">propertyOrObject</span><span class="p">,</span> <span class="nv">value </span><span class="o">=</span> <span class="kc">null</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">propertyOrObject</span> <span class="o">is</span> <span class="s">&quot;object&quot;</span>
      <span class="py">@handlePropertyChange</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">v</span> <span class="k">for</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">v</span> <span class="k">of</span> <span class="nx">propertyOrObject</span>
    <span class="k">else</span>
      <span class="py">@handlePropertyChange</span> <span class="nx">propertyOrObject</span><span class="p">,</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>The <code>handlePropertyChange</code> realize the concrete action
of a changing a property.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">handlePropertyChange</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="s">&quot;set_</span><span class="si">#{</span><span class="nx">property</span><span class="si">}</span><span class="s">&quot;</span> <span class="k">of</span> <span class="k">this</span>
      <span class="py">@</span><span class="p">[</span> <span class="s">&quot;set_</span><span class="si">#{</span><span class="nx">property</span><span class="si">}</span><span class="s">&quot;</span> <span class="p">].</span><span class="nx">call</span> <span class="k">this</span><span class="p">,</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span>
    <span class="k">else</span>
      <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>

    <span class="py">@updateStates</span><span class="p">()</span>
    <span class="py">@propertyChanged</span><span class="p">.</span><span class="nx">dispatch</span> <span class="k">this</span><span class="p">,</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>Creates a new property for this widget, optionally accessors functions
can be provided. In any case, the property will be readable and writable.</p>

<p>Accessors functions are called with the current widget as scope.</p>

<p>The setter accessor must affect the value to the property and then
return the final value. If the target should change after the modification
of the property, the setter should take care of the reflecting
the changes on the target.</p>

<p>When creating a new property in a children class, define the accessors
functions as methods in the class body to allow overrides in subclasses.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">createProperty</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nv">value</span><span class="o">=</span><span class="kc">undefined</span><span class="p">,</span> <span class="nv">setter</span><span class="o">=</span><span class="kc">null</span><span class="p">,</span> <span class="nv">getter</span><span class="o">=</span><span class="kc">null</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>

    <span class="py">@</span><span class="p">[</span> <span class="s">&quot;set_</span><span class="si">#{</span><span class="nx">property</span><span class="si">}</span><span class="s">&quot;</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">setter</span> <span class="k">if</span> <span class="nx">setter</span><span class="o">?</span>
    <span class="py">@</span><span class="p">[</span> <span class="s">&quot;get_</span><span class="si">#{</span><span class="nx">property</span><span class="si">}</span><span class="s">&quot;</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">getter</span> <span class="k">if</span> <span class="nx">getter</span><span class="o">?</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>The accessors functions for the widget's properties.</p>

<p>Setters accessors are prefixed with <code>set_</code> and getters's
one with <code>get_</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>A widget is disabled if its own disabled property is <code>true</code>
or if it's a child of a disabled widget.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">get_disabled</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="nv">res </span><span class="o">=</span> <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span>
    <span class="nv">res </span><span class="o">=</span> <span class="nx">res</span> <span class="o">or</span> <span class="py">@parent</span><span class="p">.</span><span class="nx">get</span> <span class="nx">property</span> <span class="k">if</span> <span class="py">@parent</span><span class="o">?</span>
    <span class="nx">res</span>
  <span class="py">set_disabled</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span> <span class="o">=</span> <span class="py">@booleanToAttribute</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Disabled widget don't allow to receive focus.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@setFocusable</span> <span class="o">not</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>Read-only widgets don't allow their <code>value</code> to be changed.
A widget is readonly if its own readonly property is <code>true</code>
or if it's a child of a readonly widget.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">get_readonly</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="nv">res </span><span class="o">=</span> <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span>
    <span class="nv">res </span><span class="o">=</span> <span class="nx">res</span> <span class="o">or</span> <span class="py">@parent</span><span class="p">.</span><span class="nx">get</span> <span class="nx">property</span> <span class="k">if</span> <span class="py">@parent</span><span class="o">?</span>
    <span class="nx">res</span>
  <span class="py">set_readonly</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span> <span class="o">=</span> <span class="py">@booleanToAttribute</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>Required widgets prevents a form to be submitted if it don't validate.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">set_required</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span> <span class="o">=</span> <span class="py">@booleanToAttribute</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Sets the value of both the widget and its target if the widget
allow it.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">set_value</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="p">)</span><span class="o">-&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Read-only widgets don't allow to modify their values.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="py">@get</span> <span class="s">&quot;readonly&quot;</span>
      <span class="k">return</span> <span class="py">@get</span> <span class="nx">property</span>
    <span class="k">else</span>
      <span class="k">if</span> <span class="nx">value</span> <span class="o">isnt</span> <span class="py">@get</span> <span class="nx">property</span>
        <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>
        <span class="py">@valueToAttribute</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span>
        <span class="py">@valueChanged</span><span class="p">.</span><span class="nx">dispatch</span> <span class="k">this</span><span class="p">,</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>Sets the name of the target.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">set_name</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span> <span class="o">=</span> <span class="py">@valueToAttribute</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>The <code>id</code> setter operate only on the dummy, and not on the target.
It preserve the uniqueness of ids of the form inputs (given that
they are originally unique).</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">set_id</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="nx">value</span><span class="o">?</span>
      <span class="py">@dummy</span><span class="o">?</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="nx">value</span>
    <span class="k">else</span>
      <span class="py">@dummy</span><span class="o">?</span><span class="p">.</span><span class="nx">removeAttr</span> <span class="s">&quot;id&quot;</span>

    <span class="py">@</span><span class="p">[</span> <span class="nx">property</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <h3>Target Management</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>Verify that the passed-in target is valid and throw an error
if itsn't the case.</p>

<p>By default a <code>target</code> can be any <code>HTMLElement</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">checkTarget</span><span class="o">:</span><span class="p">(</span> <span class="nx">target</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span> <span class="s">&quot;Widget&#39;s target should be a node&quot;</span> <span class="k">unless</span> <span class="py">@isElement</span> <span class="nx">target</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>A function that verify that the passed-in argument
is an HTML element.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">isElement</span><span class="o">:</span><span class="p">(</span> <span class="nx">o</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nb">HTMLElement</span> <span class="o">is</span> <span class="s">&quot;object&quot;</span>
      <span class="nx">o</span> <span class="k">instanceof</span> <span class="nb">HTMLElement</span>
    <span class="k">else</span>
      <span class="k">typeof</span> <span class="nx">o</span> <span class="o">is</span> <span class="s">&quot;object&quot;</span> <span class="o">and</span>
      <span class="nx">o</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">is</span> <span class="mi">1</span> <span class="o">and</span>
      <span class="k">typeof</span> <span class="nx">o</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">is</span> <span class="s">&quot;string&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>A function that verify that the passed-in argument
is a <code>tag</code> node.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">isTag</span><span class="o">:</span><span class="p">(</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">tag</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@isElement</span><span class="p">(</span> <span class="nx">o</span> <span class="p">)</span> <span class="o">and</span> <span class="nx">o</span><span class="o">?</span><span class="p">.</span><span class="nx">nodeName</span><span class="o">?</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">is</span> <span class="nx">tag</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>A function that verify that the passed-in object is
an input node with a type contained in <code>types</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">isInputWithType</span><span class="o">:</span><span class="p">(</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">types</span><span class="p">...</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@isTag</span><span class="p">(</span> <span class="nx">o</span><span class="p">,</span> <span class="s">&quot;input&quot;</span> <span class="p">)</span> <span class="o">and</span> <span class="nx">$</span><span class="p">(</span> <span class="nx">o</span> <span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span> <span class="k">in</span> <span class="nx">types</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Hide the target if provided.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">hideTarget</span><span class="o">:-&gt;</span>
    <span class="py">@jTarget</span><span class="p">.</span><span class="nx">hide</span><span class="p">()</span> <span class="k">if</span> <span class="py">@hasTarget</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>Reset the target as a <code>&lt;input type='reset'&gt;</code> could do.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">reset</span><span class="o">:-&gt;</span> <span class="py">@set</span> <span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="py">@targetInitialValue</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>A placeholder for the target's change event.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">targetChange</span><span class="o">:</span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span><span class="o">-&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <h3>Dummy Management</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>Returns <code>true</code> when the widget is not in a state that allow
a change to the value with a user interaction.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">cantInteract</span><span class="o">:-&gt;</span> <span class="py">@get</span><span class="p">(</span><span class="s">&quot;readonly&quot;</span><span class="p">)</span> <span class="o">or</span> <span class="py">@get</span><span class="p">(</span><span class="s">&quot;disabled&quot;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>A placeholder for dummy creation.
The method must return the dummy jQuery object.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">createDummy</span><span class="o">:-&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>Updates the state of the dummy according to the current values
in the widget's properties.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">updateStates</span><span class="o">:-&gt;</span>
    <span class="k">if</span> <span class="py">@hasDummy</span>
      <span class="nv">oldState </span><span class="o">=</span> <span class="py">@dummy</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&quot;class&quot;</span>
      <span class="nv">newState </span><span class="o">=</span> <span class="s">&quot;&quot;</span>
      <span class="k">for</span> <span class="nx">state</span> <span class="k">in</span> <span class="py">@dummyStates</span>
        <span class="k">if</span> <span class="py">@get</span> <span class="nx">state</span>
          <span class="nx">newState</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span> <span class="k">if</span> <span class="nx">newState</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
          <span class="nx">newState</span> <span class="o">+=</span> <span class="nx">state</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>Since some widgets will place the focus on a dummy's child
instead of the dummy itself, the <code>focus</code> state is reflected
in the dummy's class attribute.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="py">@hasFocus</span> <span class="k">then</span> <span class="nv">newState </span><span class="o">=</span> <span class="s">&quot;focus </span><span class="si">#{</span><span class="nx">newState</span><span class="si">}</span><span class="s">&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>Original and state classes are concatened
to produce the output dummy class.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">outputState </span><span class="o">=</span> <span class="k">if</span> <span class="py">@dummyClass</span><span class="o">?</span> <span class="o">and</span> <span class="nx">newState</span> <span class="o">isnt</span> <span class="s">&quot;&quot;</span>
        <span class="py">@dummyClass</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="nx">newState</span>
      <span class="k">else</span> <span class="k">if</span> <span class="py">@dummyClass</span><span class="o">?</span>
        <span class="py">@dummyClass</span>
      <span class="k">else</span>
        <span class="nx">newState</span>

      <span class="k">if</span> <span class="nx">outputState</span> <span class="o">isnt</span> <span class="nx">oldState</span>
        <span class="py">@dummy</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&quot;class&quot;</span><span class="p">,</span> <span class="nx">outputState</span>
        <span class="py">@stateChanged</span><span class="p">.</span><span class="nx">dispatch</span> <span class="k">this</span><span class="p">,</span> <span class="nx">newState</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>Adds a list of classes in the dummy <code>class</code> attribute.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">addClasses</span><span class="o">:</span><span class="p">(</span> <span class="nx">classes</span><span class="p">...</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="nv">dummyClasses </span><span class="o">=</span> <span class="py">@dummyClass</span><span class="o">?</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span> <span class="o">or</span> <span class="p">[]</span>

    <span class="nx">dummyClasses</span><span class="p">.</span><span class="nx">push</span> <span class="nx">cl</span> <span class="k">for</span> <span class="nx">cl</span> <span class="k">in</span> <span class="nx">classes</span> <span class="k">when</span> <span class="nx">cl</span> <span class="o">not</span> <span class="k">in</span> <span class="nx">dummyClasses</span>

    <span class="py">@dummyClass</span> <span class="o">=</span> <span class="nx">dummyClasses</span><span class="p">.</span><span class="nx">join</span> <span class="s">&quot; &quot;</span>
    <span class="py">@updateStates</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>Removes a list of classes from the dummy <code>class</code> attribute.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">removeClasses</span><span class="o">:</span><span class="p">(</span> <span class="nx">classes</span><span class="p">...</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="nv">dummyClasses </span><span class="o">=</span> <span class="py">@dummyClass</span><span class="p">.</span><span class="nx">split</span> <span class="s">&quot; &quot;</span>
    <span class="nv">output </span><span class="o">=</span> <span class="p">(</span> <span class="nx">cl</span> <span class="k">for</span> <span class="nx">cl</span> <span class="k">in</span> <span class="nx">dummyClasses</span> <span class="k">when</span> <span class="nx">cl</span> <span class="o">not</span> <span class="k">in</span> <span class="nx">classes</span> <span class="p">)</span>

    <span class="py">@dummyClass</span> <span class="o">=</span> <span class="nx">output</span><span class="p">.</span><span class="nx">join</span> <span class="s">&quot; &quot;</span>
    <span class="py">@updateStates</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>Append the widget's dummy to the passed-in target.
The <code>target</code> can be either a string or a <code>jQuery</code> object.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">attach</span><span class="o">:</span><span class="p">(</span> <span class="nx">target</span> <span class="p">)</span><span class="o">-&gt;</span> <span class="py">@handleDOMInsertion</span> <span class="nx">target</span><span class="p">,</span> <span class="s">&quot;append&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>Insert the widget's dummy before the passed-in <code>target</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">before</span><span class="o">:</span><span class="p">(</span> <span class="nx">target</span> <span class="p">)</span><span class="o">-&gt;</span> <span class="py">@handleDOMInsertion</span> <span class="nx">target</span><span class="p">,</span> <span class="s">&quot;before&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>Insert the widget's dummy after the passed-in <code>target</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">after</span><span class="o">:</span><span class="p">(</span> <span class="nx">target</span> <span class="p">)</span><span class="o">-&gt;</span> <span class="py">@handleDOMInsertion</span> <span class="nx">target</span><span class="p">,</span> <span class="s">&quot;after&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p>Handles the insertion of the widget's dummy in the DOM.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">handleDOMInsertion</span><span class="o">:</span><span class="p">(</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">action</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="nx">target</span><span class="o">?</span>
      <span class="nv">target </span><span class="o">=</span> <span class="nx">$</span> <span class="nx">target</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">target</span> <span class="o">is</span> <span class="s">&quot;string&quot;</span>
      <span class="nx">target</span><span class="p">[</span> <span class="nx">action</span> <span class="p">]</span> <span class="py">@dummy</span>
      <span class="py">@attached</span><span class="p">.</span><span class="nx">dispatch</span> <span class="k">this</span></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p>Detach the widget's dummy from the DOM.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">detach</span><span class="o">:-&gt;</span>
    <span class="py">@dummy</span><span class="p">.</span><span class="nx">detach</span><span class="p">()</span>
    <span class="py">@detached</span><span class="p">.</span><span class="nx">dispatch</span> <span class="k">this</span></pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <h3>Dummy Events Handling</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <p>Register this widget to the events of its dummy.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">registerToDummyEvents</span><span class="o">:-&gt;</span>
    <span class="py">@dummy</span><span class="p">.</span><span class="nx">bind</span> <span class="py">@supportedEvents</span><span class="p">,</span> <span class="p">(</span> <span class="nx">e</span> <span class="p">)</span><span class="o">=&gt;</span>
      <span class="py">@</span><span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">type</span><span class="p">].</span><span class="nx">apply</span> <span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <p>Unregister all the events from the dummy.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">unregisterFromDummyEvents</span><span class="o">:-&gt;</span> <span class="py">@dummy</span><span class="p">.</span><span class="nx">unbind</span> <span class="py">@supportedEvents</span></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <p>The list of the dummy's events supported by the widget.
All these events are catched by the methods with
the corresponding name in the widget class.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">supportedEvents</span><span class="o">:</span><span class="p">[</span>
    <span class="s">&quot;mousedown&quot;</span><span class="p">,</span> <span class="s">&quot;mouseup&quot;</span><span class="p">,</span>    <span class="s">&quot;mousemove&quot;</span><span class="p">,</span> <span class="s">&quot;mouseover&quot;</span><span class="p">,</span>
    <span class="s">&quot;mouseout&quot;</span><span class="p">,</span>  <span class="s">&quot;mousewheel&quot;</span><span class="p">,</span> <span class="s">&quot;click&quot;</span><span class="p">,</span>     <span class="s">&quot;dblclick&quot;</span><span class="p">,</span>
    <span class="s">&quot;focus&quot;</span><span class="p">,</span>     <span class="s">&quot;blur&quot;</span><span class="p">,</span>       <span class="s">&quot;keyup&quot;</span><span class="p">,</span>     <span class="s">&quot;keydown&quot;</span><span class="p">,</span>
    <span class="s">&quot;keypress&quot;</span><span class="p">,</span>
  <span class="p">].</span><span class="nx">join</span> <span class="s">&quot; &quot;</span></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p>Override these placeholders to implement the concrete events
handlers of a widget class.</p>

<p><strong>Note:</strong> Be aware that, unfortunately, all browsers doesn't
support the <code>focus</code> and <code>blur</code> events on nodes other than
<code>input</code>, <code>textarea</code>, <code>select</code> and <code>a</code>. And since keyboard events
on DOM objects are only available when the object has the focus
you will lose the keyboard events as side effect.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">mousedown </span><span class="o">:-&gt;</span> <span class="kc">true</span>
  <span class="py">mouseup   </span><span class="o">:-&gt;</span> <span class="kc">true</span>
  <span class="py">mousemove </span><span class="o">:-&gt;</span> <span class="kc">true</span>
  <span class="py">mouseover </span><span class="o">:-&gt;</span> <span class="kc">true</span>
  <span class="py">mouseout  </span><span class="o">:-&gt;</span> <span class="kc">true</span>
  <span class="py">mousewheel</span><span class="o">:-&gt;</span> <span class="kc">true</span>
  <span class="py">click     </span><span class="o">:-&gt;</span> <span class="kc">true</span>
  <span class="py">dblclick  </span><span class="o">:-&gt;</span> <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <p>Default behavior is to allow focus only if the widget is enabled.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">focus</span><span class="o">:</span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@hasFocus</span> <span class="o">=</span> <span class="kc">true</span> <span class="k">if</span> <span class="o">not</span> <span class="py">@get</span> <span class="s">&quot;disabled&quot;</span>
    <span class="py">@updateStates</span><span class="p">()</span>
    <span class="o">not</span> <span class="py">@get</span> <span class="s">&quot;disabled&quot;</span>

  <span class="py">blur</span><span class="o">:</span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@hasFocus</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="py">@updateStates</span><span class="p">()</span>
    <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <p>Trigger the command registered with the <code>keydown</code> event if any.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">keydown</span><span class="o">:</span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span><span class="o">-&gt;</span> <span class="py">@triggerKeyDownCommand</span> <span class="nx">e</span></pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p>Trigger the command registered with the <code>keyup</code> event if any.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">keyup</span><span class="o">:</span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span><span class="o">-&gt;</span> <span class="py">@triggerKeyUpCommand</span> <span class="nx">e</span>

  <span class="py">keypress</span><span class="o">:</span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span><span class="o">-&gt;</span> <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <h3>Focus Management</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <p>Set the focusable state of the dummy.
It simply toggle the <code>tabindex</code> attributes
on the dummy to ensure that it cannot receive focus.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">setFocusable</span><span class="o">:</span><span class="p">(</span> <span class="nx">allowFocus</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="py">@hasDummy</span>
      <span class="k">if</span> <span class="nx">allowFocus</span> <span class="k">then</span> <span class="py">@dummy</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&quot;tabindex&quot;</span><span class="p">,</span> <span class="mi">0</span>
      <span class="k">else</span> <span class="py">@dummy</span><span class="p">.</span><span class="nx">removeAttr</span> <span class="s">&quot;tabindex&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <p>Place the focus on this widget.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">grabFocus</span><span class="o">:-&gt;</span> <span class="py">@dummy</span><span class="p">.</span><span class="nx">focus</span><span class="p">()</span> <span class="k">if</span> <span class="py">@hasDummy</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <p>Remove the focus from this widget.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">releaseFocus</span><span class="o">:-&gt;</span> <span class="py">@dummy</span><span class="p">.</span><span class="nx">blur</span><span class="p">()</span> <span class="k">if</span> <span class="py">@hasDummy</span></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <h3>Keyboard Shortcuts Management</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <p>Register the passed-in function to be triggered
when the keystroke <code>ks</code> is matched on <code>keydown</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">registerKeyDownCommand</span><span class="o">:</span><span class="p">(</span> <span class="nx">ks</span><span class="p">,</span> <span class="nx">command</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@keyDownCommands</span><span class="p">[</span> <span class="nx">ks</span> <span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">ks</span><span class="p">,</span> <span class="nx">command</span> <span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p>Register the passed-in function to be triggered
when the keystroke <code>ks</code> is matched on <code>keyup</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">registerKeyUpCommand</span><span class="o">:</span><span class="p">(</span> <span class="nx">ks</span><span class="p">,</span> <span class="nx">command</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@keyUpCommands</span><span class="p">[</span> <span class="nx">ks</span> <span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">ks</span><span class="p">,</span> <span class="nx">command</span> <span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <p>Returns <code>yes</code> if the passed-in keystroke have been associated
with a command for this widget's <code>keydown</code> event.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">hasKeyDownCommand</span><span class="o">:</span><span class="p">(</span> <span class="nx">ks</span> <span class="p">)</span><span class="o">-&gt;</span> <span class="nx">ks</span> <span class="k">of</span> <span class="py">@keyDownCommands</span></pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <p>Returns <code>yes</code> if the passed-in keystroke have been associated
with a command for this widget's <code>keyup</code> event.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">hasKeyUpCommand</span><span class="o">:</span><span class="p">(</span> <span class="nx">ks</span> <span class="p">)</span><span class="o">-&gt;</span> <span class="nx">ks</span> <span class="k">of</span> <span class="py">@keyUpCommands</span></pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <p>Takes a keyboard event object and trigger
the corresponding command on a <code>keydown</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">triggerKeyDownCommand</span><span class="o">:</span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">for</span> <span class="nx">key</span><span class="p">,</span> <span class="p">[</span> <span class="nx">ks</span><span class="p">,</span> <span class="nx">command</span> <span class="p">]</span> <span class="k">of</span> <span class="py">@keyDownCommands</span>
      <span class="k">return</span> <span class="nx">command</span><span class="p">.</span><span class="nx">call</span> <span class="k">this</span><span class="p">,</span> <span class="nx">e</span> <span class="k">if</span> <span class="nx">ks</span><span class="p">.</span><span class="nx">match</span> <span class="nx">e</span></pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <p>Keyboards events are bubbled to the parent.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@parent</span><span class="p">.</span><span class="nx">triggerKeyDownCommand</span> <span class="nx">e</span> <span class="k">if</span> <span class="py">@parent</span><span class="o">?</span>
    <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <p>Takes a keyboard event object and trigger
the corresponding command on a <code>keyup</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">triggerKeyUpCommand</span><span class="o">:</span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">for</span> <span class="nx">key</span><span class="p">,</span> <span class="p">[</span> <span class="nx">ks</span><span class="p">,</span> <span class="nx">command</span> <span class="p">]</span> <span class="k">of</span> <span class="py">@keyUpCommands</span>
      <span class="k">return</span> <span class="nx">command</span><span class="p">.</span><span class="nx">call</span> <span class="k">this</span><span class="p">,</span> <span class="nx">e</span> <span class="k">if</span> <span class="nx">ks</span><span class="p">.</span><span class="nx">match</span> <span class="nx">e</span></pre></div>             </td>           </tr>                               <tr id="section-85">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-85">&#182;</a>               </div>               <p>Keyboards events are bubbled to the parent.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="py">@parent</span><span class="p">.</span><span class="nx">triggerKeyUpCommand</span> <span class="nx">e</span> <span class="k">if</span> <span class="py">@parent</span><span class="o">?</span>
    <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-86">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-86">&#182;</a>               </div>               <h3>Target Attributes Management</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-87">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-87">&#182;</a>               </div>               <p>Uses theses methods to retreive or copy data
from the target's attributes.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">valueFromAttribute</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nv">defaultValue </span><span class="o">=</span> <span class="kc">undefined</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="py">@hasTarget</span> <span class="k">then</span> <span class="py">@jTarget</span><span class="p">.</span><span class="nx">attr</span> <span class="nx">property</span> <span class="k">else</span> <span class="nx">defaultValue</span>

  <span class="py">valueToAttribute</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="py">@jTarget</span><span class="p">.</span><span class="nx">attr</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="k">if</span> <span class="py">@hasTarget</span>
    <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-88">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-88">&#182;</a>               </div>               <p>The following two methods handle the special case of attributes
for which only presence is meaningful.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">booleanFromAttribute</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nv">defaultValue </span><span class="o">=</span> <span class="kc">undefined</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="py">@hasTarget</span> <span class="k">then</span> <span class="py">@jTarget</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span> <span class="nx">property</span> <span class="p">)</span> <span class="o">isnt</span> <span class="kc">undefined</span>
    <span class="k">else</span> <span class="nx">defaultValue</span>

  <span class="py">booleanToAttribute</span><span class="o">:</span><span class="p">(</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="py">@hasTarget</span>
      <span class="k">if</span> <span class="nx">value</span> <span class="k">then</span> <span class="py">@jTarget</span><span class="p">.</span><span class="nx">attr</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">property</span>
      <span class="k">else</span> <span class="py">@jTarget</span><span class="p">.</span><span class="nx">removeAttr</span> <span class="nx">property</span>
    <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-89">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-89">&#182;</a>               </div>               <h3>Miscelaneous Functions</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-90">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-90">&#182;</a>               </div>               <p>Returns the string representation of this widget.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">toString</span><span class="o">:-&gt;</span> <span class="py">@stringify</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-91">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-91">&#182;</a>               </div>               <p>Returns a string representation of this widget.
By default, the <code>id</code> of the widget is displayed
if not null.
A <code>details</code> array can be passed to the <code>stringify</code>
function, containing a list of properties's names
to append to the output string.</p>

<p>For instance, a call to :</p>

<pre><code>@stringify "name"
</code></pre>

<p>For a widget with an <code>id</code> and a <code>name</code> will return</p>

<pre><code>[object Widget(id="id", name="name")]
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="py">stringify</span><span class="o">:</span><span class="p">(</span> <span class="nx">details</span><span class="p">...</span> <span class="p">)</span><span class="o">-&gt;</span>
    <span class="nv">args </span><span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="nv">a </span><span class="o">=</span> <span class="p">[]</span>
    <span class="nx">a</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;id=\&quot;</span><span class="si">#{</span> <span class="py">@get</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">)</span> <span class="si">}</span><span class="s">\&quot;&quot;</span> <span class="k">if</span> <span class="py">@get</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">)</span><span class="o">?</span>
    <span class="nx">a</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;</span><span class="si">#{</span> <span class="nx">d</span> <span class="si">}</span><span class="s">=\&quot;</span><span class="si">#{</span> <span class="py">@get</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="si">}</span><span class="s">\&quot;&quot;</span> <span class="k">for</span> <span class="nx">d</span> <span class="k">in</span> <span class="nx">details</span> <span class="k">when</span> <span class="py">@get</span><span class="p">(</span> <span class="nx">d</span> <span class="p">)</span><span class="o">?</span>

    <span class="nv">args </span><span class="o">=</span> <span class="s">&quot;(</span><span class="si">#{</span> <span class="nx">a</span><span class="p">.</span><span class="nx">join</span> <span class="s">&quot;, &quot;</span> <span class="si">}</span><span class="s">)&quot;</span> <span class="k">if</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="s">&quot;[object </span><span class="si">#{</span> <span class="py">@constructor</span><span class="p">.</span><span class="nx">name</span> <span class="si">}#{</span> <span class="nx">args</span> <span class="si">}</span><span class="s">]&quot;</span>

<span class="py">@Widget</span> <span class="o">=</span> <span class="nb">Widget</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 